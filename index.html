<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
  <title>Tech SEO Master</title>
  
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0b1020">
  <link rel="apple-touch-icon" href="icon-192.png">

  <style>
    :root{
      --bg:#0b1020; --card:rgba(255,255,255,0.08);
      --text:#f0f0f0; --accent:#7c5cff; --ok:#00d2ff; --ng:#ff4757;
    }
    body {
      margin:0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: var(--bg); color: var(--text); overflow-x: hidden;
      -webkit-tap-highlight-color: transparent;
    }
    .app-container { max-width: 600px; margin: 0 auto; padding: 20px; min-height: 100vh; display: flex; flex-direction: column; }
    
    header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
    h1 { font-size: 20px; font-weight: 800; background: linear-gradient(to right, #7c5cff, #22c1c3); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 0; }
    
    .card {
      background: var(--card); border-radius: 24px; padding: 24px;
      backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.1);
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
      transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
    }
    
    @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    .slide-in { animation: slideIn 0.4s ease-out forwards; }

    .progress-track { height: 6px; background: rgba(255,255,255,0.1); border-radius: 10px; margin: 20px 0; overflow: hidden; }
    .progress-fill { height: 100%; background: var(--accent); width: 0%; transition: width 0.4s ease; }

    .question { font-size: 18px; font-weight: 700; line-height: 1.5; margin-bottom: 24px; min-height: 60px;}
    .tag { font-size: 11px; color: rgba(255,255,255,0.6); border: 1px solid rgba(255,255,255,0.2); padding: 3px 8px; border-radius: 6px; vertical-align: middle; margin-right: 6px; }

    .btn-option {
      width: 100%; text-align: left; padding: 16px; margin-bottom: 12px;
      background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
      border-radius: 16px; color: var(--text); font-size: 14px; font-weight: 600;
      transition: all 0.2s; cursor: pointer; position: relative;
    }
    .btn-option:active { transform: scale(0.98); background: rgba(255,255,255,0.1); }
    .btn-option.correct { background: rgba(0, 210, 255, 0.2); border-color: var(--ok); color: var(--ok); }
    .btn-option.wrong { background: rgba(255, 71, 87, 0.2); border-color: var(--ng); }
    
    .explanation {
      display: none; background: rgba(0,0,0,0.3); padding: 16px; border-radius: 16px;
      margin-top: 20px; font-size: 13px; line-height: 1.6; border-left: 4px solid var(--accent);
    }
    .explanation.show { display: block; animation: slideIn 0.3s ease; }

    .btn-next {
      width: 100%; padding: 16px; margin-top: 20px; background: var(--accent); border: none;
      border-radius: 14px; color: #fff; font-weight: bold; font-size: 16px;
      display: none; cursor: pointer; box-shadow: 0 4px 15px rgba(124, 92, 255, 0.4);
      transition: transform 0.1s; /* ã‚¯ãƒªãƒƒã‚¯æ„Ÿã‚’è¿½åŠ  */
    }
    .btn-next:active { transform: scale(0.98); opacity: 0.9; } /* æŠ¼ã—ãŸæ™‚ã«å‡¹ã‚€æ¼”å‡º */

    .rank-badge { font-size: 48px; font-weight: 900; color: var(--ok); text-shadow: 0 0 20px var(--ok); display:block; margin: 10px 0;}

    footer { text-align: center; color: rgba(255,255,255,0.4); font-size: 12px; margin-top: auto; padding-top: 20px; }
  </style>
</head>
<body>

<div class="app-container">
  <header>
    <h1>Tech SEO Master</h1>
    <div id="status-bar" style="font-size:13px; font-weight:bold; color:var(--accent);">æº–å‚™ä¸­...</div>
  </header>

  <div id="start-screen" class="card slide-in">
    <h2 style="text-align:center;">å®ŸåŠ›è¨ºæ–­ãƒ†ã‚¹ãƒˆ</h2>
    <p style="opacity:0.8; text-align:center; font-size:14px; margin-bottom:30px;">
      å…¨100å•ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰<br>
      ãƒ©ãƒ³ãƒ€ãƒ ã«<strong style="color:var(--ok)">30å•</strong>å‡ºé¡Œã•ã‚Œã¾ã™ã€‚<br>
      ã‚ãªãŸã®ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«SEOåŠ›ã‚’æ¸¬å®šã—ã¾ã™ã€‚
    </p>
    <button class="btn-next" onclick="startQuiz()" style="display:block;">ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹ã™ã‚‹</button>
  </div>

  <div id="game-card" class="card" style="display:none;">
    <div class="progress-track"><div id="progress" class="progress-fill"></div></div>
    <div id="q-meta" style="margin-bottom:8px;"></div>
    <div id="question" class="question"></div>
    <div id="options"></div>
    <div id="explanation" class="explanation"></div>
    <button id="btn-next" class="btn-next" onclick="nextQuestion()">æ¬¡ã®å•é¡Œã¸</button>
  </div>

  <footer>
    Created by <a href="https://twitter.com/OkaTakuma1" target="_blank" style="color:var(--accent); text-decoration:none; font-weight:bold;">Takuma Oka</a>
  </footer>
</div>

<script>
// --- 100å•ã®ãƒ•ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ ---
// ã€é‡è¦ã€‘ã“ã“ã«å‰å›ã®100å•ãƒ‡ãƒ¼ã‚¿ã‚’å¿…ãšã™ã¹ã¦è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ï¼
const ALL_QUESTIONS = [
  { id: "q001", tags: ["Index"], q: "meta robots noindex ã®ä¸»ãªç›®çš„ã¯ï¼Ÿ", choices: ["ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’ä¸Šã’ã‚‹", "ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‹ã‚‰é™¤å¤–ã•ã›ã‚‹æ„å›³ã‚’ä¼ãˆã‚‹", "ã‚¯ãƒ­ãƒ¼ãƒ«é »åº¦ã‚’ä¸Šã’ã‚‹", "å¿…ãš301ã‚’ç™ºç”Ÿã•ã›ã‚‹"], ans: 1, exp: "noindexã¯æ¤œç´¢çµæœã«å‡ºã•ãªã„æ„å›³ã‚’ä¼ãˆã‚‹ï¼ˆå‘½ä»¤ã§ã¯ãªãè§£é‡ˆã•ã‚Œã‚‹ï¼‰ã€‚" },
  { id: "q002", tags: ["Crawl"], q: "robots.txt ã§ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹ã¨èµ·ã“ã‚Šã‚„ã™ã„ã“ã¨ã¯ï¼Ÿ", choices: ["ãƒšãƒ¼ã‚¸å†…å®¹ã‚’è§£æã§ãã‚‹", "ãƒšãƒ¼ã‚¸ã‚’å–å¾—ã§ããªã„ãŸã‚noindexç­‰ã‚’èª­ã‚ãªã„", "å¿…ãšã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒæ¶ˆãˆã‚‹", "å¿…ãš404ã«ãªã‚‹"], ans: 1, exp: "robotsãƒ–ãƒ­ãƒƒã‚¯ã¯å–å¾—è‡ªä½“ã‚’æ­¢ã‚ã‚‹ãŸã‚ã€ãƒ¡ã‚¿æƒ…å ±ã‚’èª­ã‚ãªã„ã“ã¨ãŒã‚ã‚‹ã€‚" },
  { id: "q003", tags: ["Canonical"], q: "rel=canonical ã®ä½ç½®ã¥ã‘ã¨ã—ã¦æœ€ã‚‚æ­£ã—ã„ã®ã¯ï¼Ÿ", choices: ["å¼·åˆ¶å‘½ä»¤", "æ­£è¦URLã®ã‚·ã‚°ãƒŠãƒ«ï¼ˆãƒ’ãƒ³ãƒˆï¼‰", "å¿…ãšnoindexã«ã™ã‚‹", "å¿…ãš301ã™ã‚‹"], ans: 1, exp: "canonicalã¯ãƒ’ãƒ³ãƒˆã€‚å†…éƒ¨ãƒªãƒ³ã‚¯/ã‚µã‚¤ãƒˆãƒãƒƒãƒ—/ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆç­‰ã¨ã®æ•´åˆãŒé‡è¦ã€‚" },
  { id: "q004", tags: ["Sitemap"], q: "XMLã‚µã‚¤ãƒˆãƒãƒƒãƒ—ã®å½¹å‰²ã¨ã—ã¦æ­£ã—ã„ã®ã¯ï¼Ÿ", choices: ["æ²è¼‰URLã¯å¿…ãšã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹", "ç™ºè¦‹ã¨ã‚¯ãƒ­ãƒ¼ãƒ«ã®æ‰‹ãŒã‹ã‚Š", "ãƒ©ãƒ³ã‚­ãƒ³ã‚°è¦å› ãã®ã‚‚ã®", "é‡è¤‡URLã‚’è‡ªå‹•å‰Šé™¤"], ans: 1, exp: "ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ã¯ç™ºè¦‹/å„ªå…ˆåº¦ã®ãƒ’ãƒ³ãƒˆã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä¿è¨¼ã§ã¯ãªã„ã€‚" },
  { id: "q005", tags: ["Index"], q: "HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ 404 ãŒç¤ºã™ã®ã¯ï¼Ÿ", choices: ["æ’ä¹…ç§»è»¢", "ä¸€æ™‚ç§»è»¢", "è¦‹ã¤ã‹ã‚‰ãªã„", "ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼"], ans: 2, exp: "404ã¯Not Foundã€‚å‰Šé™¤/å­˜åœ¨ã—ãªã„URLã«è¿”ã™ã€‚" },
  // ... (ã“ã“ã«æ®‹ã‚Šã®å•é¡Œã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„) ...
  // ã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦ã‚‚ã†1å•ã ã‘å…¥ã‚Œã¦ãŠãã¾ã™ï¼ˆæœ¬ç•ªã§ã¯100å•ã™ã¹ã¦å…¥ã‚Œã¦ãã ã•ã„ï¼‰
  { id: "q044", tags: ["Hreflang"], q: "hreflang x-default ã®ç”¨é€”ã¯ï¼Ÿ", choices: ["ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨€èª/åœ°åŸŸã‚’ç¤ºã™", "é€Ÿåº¦æ”¹å–„", "ã‚¯ãƒ­ãƒ¼ãƒ«åœæ­¢", "æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿"], ans: 0, exp: "ã©ã®è¨€èªã«ã‚‚åˆã‚ãªã„å ´åˆã®æ—¢å®šURLã‚’ç¤ºã™ã€‚" }
];

const QUIZ_COUNT = 30; 
let currentDeck = [];
let currentIdx = 0;
let score = 0;

// PWAè¨­å®š
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./sw.js');
}

// ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£: é…åˆ—ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

// ã‚¯ã‚¤ã‚ºé–‹å§‹
function startQuiz() {
  const shuffled = shuffle([...ALL_QUESTIONS]);
  currentDeck = shuffled.slice(0, QUIZ_COUNT);
  currentIdx = 0;
  score = 0;
  
  document.getElementById('start-screen').style.display = 'none';
  document.getElementById('game-card').style.display = 'block';
  document.getElementById('game-card').classList.add('slide-in');
  
  loadQuestion();
}

function loadQuestion() {
  // å®‰å…¨è£…ç½®: ã‚‚ã—å•é¡Œãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã¯çµæœç”»é¢ã¸
  if (!currentDeck[currentIdx]) {
    showResult();
    return;
  }

  const q = currentDeck[currentIdx];
  const card = document.getElementById('game-card');
  
  card.classList.remove('slide-in');
  void card.offsetWidth;
  card.classList.add('slide-in');

  document.getElementById('status-bar').textContent = `æ®‹ã‚Š ${QUIZ_COUNT - currentIdx} å•`;
  document.getElementById('q-meta').innerHTML = `<span class="tag">${q.tags[0]}</span> <span style="font-size:12px;opacity:0.7">Q.${currentIdx+1}</span>`;
  document.getElementById('question').textContent = q.q;
  document.getElementById('progress').style.width = `${(currentIdx / QUIZ_COUNT) * 100}%`;

  const optsDiv = document.getElementById('options');
  optsDiv.innerHTML = "";
  q.choices.forEach((choice, i) => {
    const btn = document.createElement('button');
    btn.className = "btn-option";
    btn.textContent = choice;
    btn.onclick = () => checkAnswer(i, q.ans, btn);
    optsDiv.appendChild(btn);
  });

  document.getElementById('explanation').className = "explanation";
  document.getElementById('btn-next').style.display = "none";
}

function checkAnswer(selected, correct, btn) {
  // ä¿®æ­£: æŒ¯å‹•æ©Ÿèƒ½ã®ã‚¨ãƒ©ãƒ¼å¯¾ç­–ï¼ˆtry-catchã§å›²ã‚€ï¼‰
  try { if (navigator.vibrate) navigator.vibrate(10); } catch(e) {}

  const btns = document.querySelectorAll('.btn-option');
  btns.forEach(b => b.disabled = true);

  if (selected === correct) {
    btn.classList.add('correct');
    score++;
  } else {
    btn.classList.add('wrong');
    btns[correct].classList.add('correct');
    try { if (navigator.vibrate) navigator.vibrate([30, 50, 30]); } catch(e) {}
  }

  const expDiv = document.getElementById('explanation');
  expDiv.innerHTML = "<strong>ğŸ’¡ è§£èª¬</strong><br>" + currentDeck[currentIdx].exp;
  expDiv.classList.add('show');

  const nextBtn = document.getElementById('btn-next');
  nextBtn.textContent = (currentIdx === QUIZ_COUNT - 1) ? "çµæœã‚’è¦‹ã‚‹" : "æ¬¡ã®å•é¡Œã¸";
  nextBtn.style.display = "block";
  // onclickã®å‹•çš„å‰²ã‚Šå½“ã¦ã‚’å‰Šé™¤ï¼ˆHTMLå´ã§å®šç¾©æ¸ˆã¿ã®ãŸã‚ä¸è¦ï¼‰
}

function nextQuestion() {
  currentIdx++;
  if (currentIdx < QUIZ_COUNT) {
    loadQuestion();
  } else {
    showResult();
  }
}

function showResult() {
  const percentage = (score / QUIZ_COUNT) * 100;
  let rank = "C";
  let msg = "ã¾ã ã¾ã ã“ã‚Œã‹ã‚‰ï¼";
  
  if(percentage >= 90) { rank = "S"; msg = "å®Œç’§ï¼ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«SEOãƒã‚¹ã‚¿ãƒ¼ï¼"; }
  else if(percentage >= 70) { rank = "A"; msg = "ç´ æ™´ã‚‰ã—ã„ï¼ç¾å ´ã§æˆ¦ãˆã‚‹ãƒ¬ãƒ™ãƒ«ï¼"; }
  else if(percentage >= 50) { rank = "B"; msg = "ã‚ã¨ä¸€æ­©ï¼å¾©ç¿’ã—ã‚ˆã†ã€‚"; }

  const shareText = `ã€Tech SEO Masterã€‘å®ŸåŠ›è¨ºæ–­ãƒ†ã‚¹ãƒˆã§ã€Œãƒ©ãƒ³ã‚¯${rank}ã€ã‚’å–ã‚Šã¾ã—ãŸï¼æ­£è§£æ•°: ${score}/${QUIZ_COUNT} ${msg} #TechSEOMaster`;
  const shareUrl = "https://twitter.com/intent/tweet?text=" + encodeURIComponent(shareText) + "&url=" + encodeURIComponent(location.href);

  const card = document.getElementById('game-card');
  card.innerHTML = `
    <h2 style="text-align:center;">çµæœç™ºè¡¨</h2>
    <div style="text-align:center; margin:20px 0;">
      <span style="font-size:14px; opacity:0.7;">æ­£è§£æ•°</span><br>
      <span style="font-size:32px; font-weight:bold;">${score}</span> <span style="font-size:18px;">/ ${QUIZ_COUNT}</span>
    </div>
    <div style="text-align:center; margin-bottom:30px;">
      <span style="font-size:14px; opacity:0.7;">ãƒ©ãƒ³ã‚¯</span>
      <span class="rank-badge">${rank}</span>
      <p style="color:var(--accent); font-weight:bold;">${msg}</p>
    </div>
    
    <a href="${shareUrl}" target="_blank" class="btn-next" style="display:block; text-align:center; text-decoration:none; background:#1DA1F2; margin-bottom:12px;">
      Xã§çµæœã‚’ã‚·ã‚§ã‚¢ã™ã‚‹
    </a>

    <button class="btn-next" onclick="location.reload()" style="display:block; background:transparent; border:1px solid rgba(255,255,255,0.3);">ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã™ã‚‹</button>
  `;
}
</script>
</body>
</html>
